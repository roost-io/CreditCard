// ********RoostGPT********
/*
Test generated by RoostGPT for test dm-bugbounty-functional-openai_clone using AI Type Open AI and AI Model gpt-4o

ROOST_METHOD_HASH=f0746111b0
ROOST_METHOD_SIG_HASH=3bae2da1af

 ########## Scenario ########## 

{
  feature: 'Feature: Work Order Attribute Value Change Event\n' +
    '  The endpoint allows clients to send notifications about changes in work order attributes.',
  background: 'Background:\n' +
    '    Given the API endpoint "/listener/workOrderAttributeValueChangeEvent"\n' +
    '    And the request content type is "application/json"',
  rule: null,
  scenario: {
    title: 'Scenario: Validate success response for BOOKING_CANCELED',
    steps: 'Given the request payload for event "BOOKING_CANCELED"\n' +
      'When a POST request is sent to the endpoint\n' +
      'Then the response status code should be 200\n' +
      'And the response body should match:\n' +
      '      """\n' +
      '      {\n' +
      '        "control": {\n' +
      '          "code": 200,\n' +
      '          "message": "Ok",\n' +
      '          "type": "S"\n' +
      '        }\n' +
      '      }',
    examples: ''
  }
}

*/

// ********RoostGPT********
package org.springframework.boot.integration_tests;

import io.restassured.RestAssured;
import io.restassured.response.Response;
import io.restassured.specification.RequestSpecification;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.Assertions;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.nio.file.FileSystems;

public class ValidateSuccessResponseForBookingCanceledTest {

    private static final String PAYLOAD_FILE = "src" + FileSystems.getDefault().getSeparator() + "test" + FileSystems.getDefault().getSeparator() + "java" + FileSystems.getDefault().getSeparator() + "org" + FileSystems.getDefault().getSeparator() + "springframework" + FileSystems.getDefault().getSeparator() + "boot" + FileSystems.getDefault().getSeparator() + "integration_tests" + FileSystems.getDefault().getSeparator() + "ValidateSuccessResponseForBookingCanceledTest.csv";

    @BeforeEach
    public void setup() {
        RestAssured.baseURI = "http://localhost:8080";
    }

    @Test
    public void testValidateSuccessResponseForBookingCanceled() throws IOException {
        BufferedReader reader = new BufferedReader(new FileReader(PAYLOAD_FILE));
        String line;
        boolean isFirstLine = true;

        while ((line = reader.readLine()) != null) {
            if (isFirstLine) {
                isFirstLine = false;
                continue;
            }

            if (line.trim().isEmpty()) {
                continue;
            }

            String[] data = line.split("\\^\\|\\^");
            String method = data[0].trim();
            String url = data[1].trim();
            String reqHeaders = data[2].trim();
            String reqBody = data[3].trim();
            int responseCode = Integer.parseInt(data[4].trim());
            String responseBody = data[5].trim();

            RequestSpecification request = RestAssured.given();

            // Set request headers
            String[] headers = reqHeaders.split(",");
            for (String header : headers) {
                String[] headerKeyValue = header.split(":");
                request.header(headerKeyValue[0].trim(), headerKeyValue[1].trim());
            }

            // Set request body
            request.body(reqBody);

            // Send POST request
            Response response = request.post(url);

            // Assert the response status code
            Assertions.assertEquals(responseCode, response.getStatusCode(), "Expected status code does not match");

            // Assert the response body
            Assertions.assertEquals(responseBody, response.getBody().asString(), "Expected response body does not match");

            // Nested assertions for response body
            Assertions.assertAll(
                () -> Assertions.assertEquals(200, response.jsonPath().getInt("control.code"), "Expected control code does not match"),
                () -> Assertions.assertEquals("Ok", response.jsonPath().getString("control.message"), "Expected control message does not match"),
                () -> Assertions.assertEquals("S", response.jsonPath().getString("control.type"), "Expected control type does not match")
            );
        }

        reader.close();
    }
}
